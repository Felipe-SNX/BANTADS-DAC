<main class="d-flex flex-row w-100" style="max-height: 100vh;">
    <app-sidebar [tipoTela]="'admin'"></app-sidebar>

    <div class="w-100 p-4 d-flex flex-column align-items-center justify-content-center bg-light" style="overflow-y: auto;">

        <div class="card shadow-sm" style="width: 100%; max-width: 800px;">
            <form #meuForm="ngForm" (ngSubmit)="onSubmit()">
                
                <div class="card-header text-center p-3">
                    <h2 class="h4 mb-0" *ngIf="!editMode">Inserir Novo Gerente</h2>
                    <h2 class="h4 mb-0" *ngIf="editMode">Editar Gerente</h2>
                </div>

                <div class="card-body p-4">
                    <div class="row g-3">

                        <div class="col-12">
                            <label for="name" class="form-label">Nome</label>
                            <input type="text" class="form-control" id="name" name="name" #nameInput="ngModel" [(ngModel)]="gerente.nome" required [class.is-invalid]="nameInput.invalid && (nameInput.dirty || nameInput.touched)">
                            <div *ngIf="nameInput.invalid && (nameInput.dirty || nameInput.touched)" class="invalid-feedback">
                                O campo nome é obrigatório.
                            </div>
                        </div>

                        <div class="col-md-6">
                            <label for="CPF" class="form-label">CPF</label>
                            <input 
                                type="text" 
                                class="form-control" 
                                id="CPF" 
                                name="CPF" 
                                mask="000.000.000-00" 
                                #CPFInput="ngModel" 
                                [(ngModel)]="gerente.cpf" 
                                cpfValidator 
                                required 
                                disabled="{{editMode}}"
                                [class.is-invalid]="CPFInput.invalid && (CPFInput.dirty || CPFInput.touched)"
                            >
                            <div *ngIf="CPFInput.invalid && (CPFInput.dirty || CPFInput.touched)" class="invalid-feedback">
                                <small *ngIf="CPFInput.errors?.['required']">O campo CPF é obrigatório.</small>
                                <small *ngIf="CPFInput.errors?.['cpfInvalido']">O CPF digitado é inválido.</small>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <label for="telefone" class="form-label">Telefone</label>
                            <input type="text" class="form-control" id="telefone" name="telefone" mask="(00) 0000-0000||(00) 00000-0000" #telefoneInput="ngModel" minlength="10" [(ngModel)]="gerente.telefone" required [class.is-invalid]="telefoneInput.invalid && (telefoneInput.dirty || telefoneInput.touched)">
                            <div *ngIf="telefoneInput.invalid && (telefoneInput.dirty || telefoneInput.touched)" class="invalid-feedback">
                                <small *ngIf="telefoneInput.errors?.['required']">O campo Telefone é obrigatório.</small>
                                <small *ngIf="telefoneInput.errors?.['minlength']">O telefone parece curto demais.</small>
                            </div>
                        </div>

                        <div class="col-12">
                            <label for="email" class="form-label">Email</label>
                            <input type="email" class="form-control" id="email" name="email" placeholder="exemplo@email.com" #emailInput="ngModel" [(ngModel)]="gerente.email" email required [class.is-invalid]="emailInput.invalid && (emailInput.dirty || emailInput.touched)">
                            <div *ngIf="emailInput.invalid && (emailInput.dirty || emailInput.touched)" class="invalid-feedback">
                                <small *ngIf="emailInput.errors?.['required']">O campo email é obrigatório.</small>
                                <small *ngIf="emailInput.errors?.['email']">O email digitado é inválido.</small>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <label for="senha" class="form-label">Senha</label>
                            <input type="password" class="form-control" id="senha" name="senha" #senhaInput="ngModel" [(ngModel)]="user.senha" required>
                        </div>

                        <div class="col-md-6">
                            <label for="confirmaSenha" class="form-label">Confirme a Senha</label>
                            <input type="password" class="form-control" id="confirmaSenha" name="confirmaSenha" #confirmaSenhaInput="ngModel" [(ngModel)]="confereSenha" required [class.is-invalid]="confereSenha != user.senha && confirmaSenhaInput.touched">
                             <div *ngIf="confereSenha != user.senha && confirmaSenhaInput.touched" class="invalid-feedback">
                                As senhas não conferem.
                            </div>
                        </div>

                    </div>
                </div>

                <div class="card-footer p-3 d-flex justify-content-end gap-2">
                    <a href="/" class="btn btn-outline-secondary">Cancelar</a>
                    <button type="submit" class="btn btn-primary" *ngIf="!editMode">Salvar Gerente</button>
                    <button type="submit" class="btn btn-primary" *ngIf="editMode">Atualizar Gerente</button>
                </div>

            </form>
        </div>
    </div>
</main>